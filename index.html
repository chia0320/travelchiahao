<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>CHIA X HAOä¹å·ä¹‹æ—… - äº’å‹•å¼ (V7.0 è²»ç”¨åŠŸèƒ½å„ªåŒ–)</title>
    <style>
        /* æ–‡é’é…è‰²èˆ‡æ’ç‰ˆ */
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fcfbf7; /* æŸ”å’Œç±³ç™½èƒŒæ™¯ */
            margin: 0;
            padding: 20px;
        }
        .header {
            text-align: center;
            padding: 15px 0;
            background-color: #7f8c8d; /* æº«æš–ä¸­ç°æ¨™é¡Œ */
            color: white;
            border-radius: 10px 10px 0 0;
            margin: -20px -20px 20px -20px;
        }
        .header h1 { margin: 0; font-size: 1.5em; }

        /* æ—¥æœŸå°èˆªå¡ç‰‡å®¹å™¨ */
        .day-nav {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            margin-bottom: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            overflow-x: auto;
        }
        .day-tab {
            text-align: center;
            padding: 8px 10px;
            margin: 0 5px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            font-weight: bold;
            color: #7f8c8d;
            flex-shrink: 0;
        }
        .day-tab.active {
            background-color: #bca47c; /* æŸ”å’ŒåœŸé»ƒ/ç±³è‰² - é¸ä¸­ */
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* è¡Œç¨‹å…§å®¹å®¹å™¨ */
        .itinerary-container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
        }
        .itinerary-day { display: none; }
        .itinerary-day.active { display: block; }

        /* å¤©æ°£é¡¯ç¤ºå€å¡Šæ¨£å¼ */
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-left: 5px solid #bca47c;
            padding-left: 10px;
        }
        .day-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #5c5c5c;
            margin: 0;
        }
        .weather-box {
            font-size: 0.9em;
            color: #7f8c8d;
            text-align: right;
            line-height: 1.2;
            min-width: 100px;
            flex-shrink: 0;
        }
        .weather-temp {
            font-size: 1.2em;
            font-weight: bold;
            color: #bca47c;
        }
        .weather-icon {
            vertical-align: middle;
            margin-right: 5px;
        }
        
        /* è¡Œç¨‹å¡ç‰‡ */
        .activity-card {
            display: flex;
            align-items: flex-start;
            margin-bottom: 25px;
            padding: 15px;
            background-color: #f7f5f0; /* å¡ç‰‡æ·¡ç±³è‰²èƒŒæ™¯ */
            border-radius: 8px;
            border-left: 5px solid #7f8c8d;
            box-shadow: 0 1px 3px rgba(0,0,0,0.03);
        }
        .time-box {
            font-size: 1.1em;
            font-weight: bold;
            color: #5c5c5c;
            margin-right: 15px;
            flex-shrink: 0;
            padding-top: 5px;
        }
        .details { flex-grow: 1; }
        
        /* å¯ç·¨è¼¯å€åŸŸçš„æ¨£å¼ */
        .editable {
            cursor: pointer;
            padding: 1px 4px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .editable:hover {
            background-color: #e0e0e0; /* æ»‘é¼ ç§»å…¥æ™‚é¡¯ç¤ºæ·ºç°èƒŒæ™¯ */
        }
        .editable-input {
            width: 95%;
            padding: 5px;
            margin-top: 2px;
            margin-bottom: 2px;
            border: 1px solid #bca47c;
            border-radius: 4px;
            font-size: 1em;
            box-sizing: border-box;
        }

        .location {
            font-weight: bold;
            color: #5c5c5c;
            font-size: 1em;
            margin-bottom: 5px;
        }
        
        .description-text {
            font-size: 0.9em;
            color: #6a6a6a;
            margin-top: 5px;
            padding-top: 5px;
            border-top: 1px solid #eee;
        }

        .note { font-size: 0.8em; color: #888; margin-top: 5px; }
        .highlight { border-left: 5px solid #bca47c; }
        
        /* åœ°åœ–é€£çµæ¨£å¼ - ç¢ºä¿é€£çµä¸æœƒè¢«ç·¨è¼¯åŠŸèƒ½å½±éŸ¿ */
        .location a {
            color: #5c5c5c;
            text-decoration: none;
            border-bottom: 1px dashed #bca47c;
            cursor: pointer;
        }

        /* è²»ç”¨ç´€éŒ„è¡¨æ ¼æ¨£å¼ */
        #expense-table td {
            padding: 8px;
            border: 1px solid #ddd;
            vertical-align: middle;
        }
        #expense-table tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .expense-editable {
            cursor: pointer;
            min-height: 20px;
        }
        /* è®“ä¸‹æ‹‰é¸å–®åœ¨è¡¨æ ¼å…§å°é½Š */
        .category-select {
            width: 100%;
            padding: 5px;
            border: 1px solid #bca47c;
            border-radius: 4px;
            font-size: 1em;
            box-sizing: border-box;
        }
        .delete-btn {
            background: none;
            border: none;
            color: red;
            cursor: pointer;
            font-weight: bold;
            padding: 0;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .delete-btn:hover {
            opacity: 1;
        }
        .currency-control {
            margin-bottom: 15px;
            font-weight: bold;
            color: #5c5c5c;
        }
        .currency-select {
            padding: 8px;
            border: 1px solid #bca47c;
            border-radius: 4px;
            background-color: white;
            margin-left: 10px;
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>CHIA X HAO ğŸ‡¯ğŸ‡µ ä¹å·ä¹‹æ—…</h1>
    </div>

    <div class="day-nav">
        <div class="day-tab active" data-day="D1" data-city="Fukuoka, JP">D1 <br> 1/1</div>
        <div class="day-tab" data-day="D2" data-city="Beppu, JP">D2 <br> 1/2</div>
        <div class="day-tab" data-day="D3" data-city="Aso, JP">D3 <br> 1/3</div>
        <div class="day-tab" data-day="D4" data-city="Takachiho, JP">D4 <br> 1/4</div>
        <div class="day-tab" data-day="D5" data-city="Fukuoka, JP">D5 <br> 1/5</div>
        <div class="day-tab" data-day="D6" data-city="Fukuoka, JP">D6 <br> 1/6</div>
        <div class="day-tab" data-day="D7">ğŸ’¸ <br> èŠ±è²»</div>
    </div>

    <div class="itinerary-container">
        
        <div class="itinerary-day active" id="D1">
            <div class="day-header">
                <div class="day-title">1 æœˆ 1 æ—¥ (ä¸€) - ç¦å²¡å¸‚å€</div>
                <div class="weather-box" id="weather-D1"></div>
            </div>
            <div class="activity-card" data-id="D1A1">
                <div class="time-box editable" data-field="time">11:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">âœˆï¸ æŠµé” <a href="https://www.google.com/maps/search/?api=1&query=Fukuoka+Airport" target="_blank">ç¦å²¡æ©Ÿå ´</a></div>
                    <div class="description-text editable" data-field="desc">ä¹å·çš„ç©ºä¸­é–€æˆ¶ï¼Œåœ°éµå¯ç›´é”å¸‚å€ï¼Œå±•é–‹æ—…ç¨‹çš„ç¬¬ä¸€ç«™ã€‚</div>
                    <div class="note editable" data-field="note">è¾¦ç†å…¥å¢ƒæ‰‹çºŒã€‚</div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D1A2">
                <div class="time-box editable" data-field="time">11:30</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸš— ç§Ÿè»Šæ‰‹çºŒï¼ˆæ©Ÿå ´å–è»Šï¼‰</div>
                    <div class="description-text editable" data-field="desc">åœ¨æ©Ÿå ´ç§Ÿè»Šé»è¾¦ç†æ‰‹çºŒï¼Œæº–å‚™å±•é–‹è‡ªé§•ä¹‹æ—…ã€‚</div>
                    <div class="note editable" data-field="note">åœ°é»ï¼š<a href="https://www.google.com/maps/search/?api=1&query=ä¸‰è±ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼+ãƒ¦ãƒŠã‚¤ãƒ†ãƒƒãƒ‰ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼ç¦å²¡ç©ºæ¸¯åº—" target="_blank">ä¸‰è±ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼/ãƒ¦ãƒŠã‚¤ãƒ†ãƒƒãƒ‰ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼ç¦å²¡ç©ºæ¸¯åº—</a> (A3å‡ºå£ 14è™Ÿå…¬è»Šç‰Œ)</div>
                </div>
            </div>
            <div class="activity-card" data-id="D1A3">
                <div class="time-box editable" data-field="time">12:30</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ›ï¸ <a href="https://www.google.com/maps/search/?api=1&query=LaLaport+Fukuoka" target="_blank">LaLaport ç¦å²¡</a></div>
                    <div class="description-text editable" data-field="desc">æ–°èˆˆçš„å¤§å‹è¤‡åˆå•†å ´ï¼Œæˆ¶å¤–æœ‰ç­‰æ¯” RX-93ff Î½é‹¼å½ˆç«‹åƒï¼Œæ˜¯è³¼ç‰©èˆ‡æ‹ç…§çš„å¥½å»è™•ã€‚</div>
                    <div class="note editable" data-field="note">åƒè§€å•†å ´èˆ‡ç­‰æ¯”é‹¼å½ˆã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D1A4">
                <div class="time-box editable" data-field="time">16:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">â›²ï¸ <a href="https://www.google.com/maps/search/?api=1&query=åšå¤šé‹æ²³åŸ" target="_blank">åšå¤šé‹æ²³åŸ</a></div>
                    <div class="description-text editable" data-field="desc">çµåˆè³¼ç‰©ã€ç¾é£Ÿã€å¨›æ¨‚çš„å•†æ¥­è¨­æ–½ï¼Œå¸¸æœ‰ç²¾å½©çš„æ°´èˆç§€è¡¨æ¼”ã€‚</div>
                    <div class="note editable" data-field="note">æ™šé¤èˆ‡è³¼ç‰©ã€‚</div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D1A5">
                <div class="time-box editable" data-field="time">ä½</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ¨ <a href="https://www.google.com/maps/search/?api=1&query=S-Peria+Hotel+Hakata" target="_blank">S-Peria Hotel Hakata</a></div>
                    <div class="description-text editable" data-field="desc">åœ°é»ä½æ–¼åšå¤šï¼Œæ–¹ä¾¿éš”æ—¥å‡ºç™¼ã€‚</div>
                    <div class="note editable" data-field="note">å«æ—©é¤ã€‚</div>
                </div>
            </div>
        </div>
        
        <div class="itinerary-day" id="D2">
            <div class="day-header">
                <div class="day-title">1 æœˆ 2 æ—¥ (äºŒ) - åˆ¥åºœ & ç”±å¸ƒé™¢</div>
                <div class="weather-box" id="weather-D2"></div>
            </div>
            <div class="activity-card" data-id="D2A1">
                <div class="time-box editable" data-field="time">11:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ¦ <a href="https://www.google.com/maps/search/?api=1&query=ä¹å·é‡ç”Ÿå‹•ç‰©åœ’" target="_blank">ä¹å·é‡ç”Ÿå‹•ç‰©åœ’</a></div>
                    <div class="description-text editable" data-field="desc">å¯ä»¥åœ¨åœ’å…§æ­ä¹˜å°ˆç”¨å·´å£«æˆ–è‡ªé§•ï¼Œè¿‘è·é›¢è§€å¯ŸçŒ›ç¸å’Œå‹•ç‰©ã€‚</div>
                    <div class="note editable" data-field="note">å¾ç¦å²¡é–‹è»Šå‰å¾€ã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D2A2">
                <div class="time-box editable" data-field="time">13:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">â™¨ï¸ <a href="https://www.google.com/maps/search/?api=1&query=åˆ¥åºœåœ°ç„è°·" target="_blank">åˆ¥åºœåœ°ç„è°·</a> & ç‹­éœ§å°ä¸Šå±•æœ›æ‰€</div>
                    <div class="description-text editable" data-field="desc">åˆ¥åºœçš„è‘—åæº«æ³‰å€ï¼Œä»¥å™´ç™¼å„ç¨®å¥‡ç•°é¡è‰²å’Œå½¢ç‹€çš„æº«æ³‰è€Œèåï¼Œä¸¦åœ¨å±•æœ›å°çœºæœ›æ™¯è‰²ã€‚</div>
                    <div class="note editable" data-field="note">æµ·åœ°ç„ç­‰è§€å…‰ã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D2A3">
                <div class="time-box editable" data-field="time">15:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ›ï¸ <a href="https://www.google.com/maps/search/?api=1&query=ç”±å¸ƒé™¢æ¹¯ä¹‹åªè¡—é“" target="_blank">ç”±å¸ƒé™¢æ•£ç­–</a></div>
                    <div class="description-text editable" data-field="desc">æ¹¯ä¹‹åªè¡—é“é€›è¡—ï¼Œäº«å—ç‰¹è‰²å°åº—èˆ‡ä¸‹åˆèŒ¶æ°›åœã€‚</div>
                    <div class="note editable" data-field="note"></div>
                </div>
            </div>
            <div class="activity-card" data-id="D2A4">
                <div class="time-box editable" data-field="time">16:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ¡ <a href="https://www.google.com/maps/search/?api=1&query=æ¹¯å¸ƒé™¢ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãƒ´ã‚£ãƒ¬ãƒƒã‚¸" target="_blank">æ¹¯å¸ƒé™¢ç«¥è©±æ‘ (Yufuin Floral Village)</a></div>
                    <div class="description-text editable" data-field="desc">å……æ»¿æ­æ´²ç«¥è©±æ°›åœçš„ç‰¹è‰²å°é®ï¼Œé©åˆæ‹ç…§ç•™å¿µã€‚</div>
                    <div class="note editable" data-field="note"></div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D2A5">
                <div class="time-box editable" data-field="time">ä½</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ  <a href="https://www.google.com/maps/search/?api=1&query=Oyado+Hananoyu+Yufuin" target="_blank">èŠ±ä¹‹æ¹¯æ—…é¤¨ Oyado Hananoyu</a></div>
                    <div class="description-text editable" data-field="desc">äº«å—æ—¥å¼æº«æ³‰æ—…é¤¨ã€‚</div>
                    <div class="note editable" data-field="note">âš ï¸ **6é»å‰è¦Check in**ã€‚</div>
                </div>
            </div>
        </div>

        <div class="itinerary-day" id="D3">
            <div class="day-header">
                <div class="day-title">1 æœˆ 3 æ—¥ (ä¸‰) - é˜¿è˜‡å±±å€</div>
                <div class="weather-box" id="weather-D3"></div>
            </div>
            <div class="activity-card" data-id="D3A1">
                <div class="time-box editable" data-field="time">11:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">â›©ï¸ <a href="https://www.google.com/maps/search/?api=1&query=ä¸Šè‰²è¦‹ç†Šé‡åº§ç¥ç¤¾" target="_blank">ä¸Šè‰²è¦‹ç†Šé‡åº§ç¥ç¤¾</a></div>
                    <div class="description-text editable" data-field="desc">éš±è—åœ¨æ·±å±±ä¸­çš„ç¥ç§˜ç¥ç¤¾ï¼Œåƒé“ä¸Šçš„è‹”è˜šç‡ˆç± æ¥µå…·éˆæ°£èˆ‡ç¥ç§˜æ°›åœã€‚</div>
                    <div class="note editable" data-field="note">å¾ç”±å¸ƒé™¢é–‹è»Šå‰å¾€ã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D3A2">
                <div class="time-box editable" data-field="time">12:30</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸŒ‹ <a href="https://www.google.com/maps/search/?api=1&query=é˜¿è˜‡ä¸­å²³ç«å±±å£" target="_blank">é˜¿è˜‡ä¸­å²³ç«å±±å£</a></div>
                    <div class="description-text editable" data-field="desc">æ´»ç«å±±çš„ä¸­å¿ƒåœ°å¸¶ï¼Œèƒ½è¦ªçœ¼çœ‹åˆ°å™´ç™¼æ°£é«”çš„ç«å±±å£ï¼Œæ„Ÿå—å¤§è‡ªç„¶çš„é­„åŠ›ã€‚</div>
                    <div class="note editable" data-field="note">è¦–ç«å±±æ°£é«”ç‹€æ³æ±ºå®šæ˜¯å¦èƒ½é è¿‘ã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D3A3">
                <div class="time-box editable" data-field="time">14:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ´ <a href="https://www.google.com/maps/search/?api=1&query=è‰åƒé‡Œä¹‹æ¿±" target="_blank">è‰åƒé‡Œä¹‹æ¿±</a></div>
                    <div class="description-text editable" data-field="desc">é˜¿è˜‡å±±å£¯é—Šçš„ç«å±±å£è‰åŸï¼Œæ™¯è‰²é–‹é—Šï¼Œæ˜¯æ¬£è³é˜¿è˜‡äº”å¶½ç¾æ™¯çš„æœ€ä½³åœ°é»ã€‚</div>
                    <div class="note editable" data-field="note">å»£é—Šçš„è‰åŸæ™¯è§€ã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D3A4">
                <div class="time-box editable" data-field="time">16:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ›’ <a href="https://www.google.com/maps/search/?api=1&query=Ebisupana+Aso" target="_blank">Ebisupana Aso æ¡è³¼æ™šé¤</a></div>
                    <div class="description-text editable" data-field="desc">ç•¶åœ°çš„è¶…å¸‚ï¼Œé©åˆæ¡è³¼é£Ÿæå’Œç”Ÿæ´»ç”¨å“ï¼Œæº–å‚™æ™šä¸Šåœ¨åˆ¥å¢…çƒ¹é£ªã€‚</div>
                    <div class="note editable" data-field="note"></div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D3A5">
                <div class="time-box editable" data-field="time">ä½</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ  <a href="https://www.google.com/maps/search/?api=1&query=è—¤ã®ãƒ´ã‚£ãƒ©+Fujino+Villa+é˜¿è˜‡" target="_blank">è—¤ã®ãƒ´ã‚£ãƒ© Fujino Villa</a></div>
                    <div class="description-text editable" data-field="desc">é˜¿è˜‡å±±å€çš„ç‰¹è‰²åˆ¥å¢…ï¼Œå¯è‡ªè¡Œçƒ¹ç…®æ™šé¤ã€‚</div>
                    <div class="note editable" data-field="note">å…¥ä½å¯†ç¢¼ï¼š**0325**</div>
                </div>
            </div>
        </div>
        
        <div class="itinerary-day" id="D4">
            <div class="day-header">
                <div class="day-title">1 æœˆ 4 æ—¥ (å››) - é«˜åƒç©—</div>
                <div class="weather-box" id="weather-D4"></div>
            </div>
            <div class="activity-card" data-id="D4A1">
                <div class="time-box editable" data-field="time">10:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸš <a href="https://www.google.com/maps/search/?api=1&query=é˜¿è˜‡å±±ç›´å‡æ©ŸéŠè¦§é£›è¡Œ" target="_blank">é˜¿è˜‡å±±ãƒ˜ãƒªã‚³ãƒ—ã‚¿ãƒ¼éŠè¦§é£›è¡Œ</a></div>
                    <div class="description-text editable" data-field="desc">å¾ç©ºä¸­ä¿¯ç°é˜¿è˜‡ç«å±±å£ã€è‰åƒé‡Œä¹‹æ¿±çš„å£¯éº—æ™¯è§€ï¼Œè¦–å¤©æ°£ç‹€æ³è€Œå®šã€‚</div>
                    <div class="note editable" data-field="note">ç›´å‡æ©Ÿè§€å…‰é£›è¡Œã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D4A2">
                <div class="time-box editable" data-field="time">14:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸš‚ <a href="https://www.google.com/maps/search/?api=1&query=é«˜åƒç©—å°ç«è»Š" target="_blank">é«˜åƒç©—å°ç«è»Š</a></div>
                    <div class="description-text editable" data-field="desc">æ²¿è‘—å»¢æ£„éµé“è¡Œé§›ï¼Œç©¿æ¢­æ–¼å³½è°·ä¹‹é–“çš„è§€å…‰å°ç«è»Šï¼Œæ˜¯ç¨ç‰¹çš„é«”é©—ã€‚</div>
                    <div class="note editable" data-field="note">é«”é©—å»¢æ£„éµé“æ”¹å»ºçš„è§€å…‰å°ç«è»Šã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D4A3">
                <div class="time-box editable" data-field="time">15:30</div>
                <div class="details">
                    <div class="location editable" data-field="location">â›©ï¸ <a href="https://www.google.com/maps/search/?api=1&query=å¤©å®‰æ²³åŸ" target="_blank">å¤©å®‰æ²³åŸ</a></div>
                    <div class="description-text editable" data-field="desc">å‚³èªªä¸­ç¥æ˜èšé›†è­°äº‹ä¹‹åœ°ï¼Œå……æ»¿éˆæ°£ï¼Œæ²³åºŠä¸Šå †æ»¿äº†ä¿¡å¾’ç¥ˆé¡˜çš„çŸ³å¡”ã€‚</div>
                    <div class="note editable" data-field="note">å‚³èªªä¸­çš„ç¥è©±ä¹‹åœ°ã€‚</div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D4A4">
                <div class="time-box editable" data-field="time">ä½</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ¨ <a href="https://www.google.com/maps/search/?api=1&query=Hotel+Takachiho" target="_blank">Hotel Takachiho</a></div>
                    <div class="description-text editable" data-field="desc">ä½æ–¼é«˜åƒç©—åœ°å€ï¼Œæ–¹ä¾¿éš”å¤©æ¸…æ—©å‰å¾€åˆ’èˆ¹ã€‚</div>
                    <div class="note editable" data-field="note">å«æ—©é¤ã€‚</div>
                </div>
            </div>
        </div>

        <div class="itinerary-day" id="D5">
            <div class="day-header">
                <div class="day-title">1 æœˆ 5 æ—¥ (äº”) - è¿”ç¨‹ç¦å²¡</div>
                <div class="weather-box" id="weather-D5"></div>
            </div>
            <div class="activity-card highlight" data-id="D5A1">
                <div class="time-box editable" data-field="time">08:30</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ½ï¸ äº«ç”¨æ—©é¤</div>
                    <div class="description-text editable" data-field="desc">åœ¨é£¯åº—äº«ç”¨è±ç››çš„æ—©é¤å¾Œï¼Œæº–å‚™å‰å¾€å³½è°·åˆ’èˆ¹ã€‚</div>
                    <div class="note editable" data-field="note">8:30 å‰è¦åƒå®Œæ—©é¤ã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D5A2">
                <div class="time-box editable" data-field="time">10:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ›¶ <a href="https://www.google.com/maps/search/?api=1&query=é«˜åƒç©—å³½åˆ’èˆ¹" target="_blank">é«˜åƒç©—åˆ’èˆ¹</a></div>
                    <div class="description-text editable" data-field="desc">åœ¨é«˜åƒç©—å³½è°·çš„ç€‘å¸ƒä¸‹åˆ’èˆ¹ï¼Œæ˜¯é«”é©—å³½è°·ç¾æ™¯çš„æœ€ä½³æ–¹å¼ï¼ˆéœ€æå‰é ç´„æˆ–æ’éšŠï¼‰ã€‚</div>
                    <div class="note editable" data-field="note">é«˜åƒç©—å³½è°·åˆ’èˆ¹é«”é©— (è¦–å¤©æ°£ç‹€æ³)ã€‚</div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D5A3">
                <div class="time-box editable" data-field="time">13:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸš— é–‹è»Šè¿”å›ç¦å²¡å¸‚å€ & é‚„è»Š</div>
                    <div class="description-text editable" data-field="desc">å¾é«˜åƒç©—é–‹è»Šè¿”å›ç¦å²¡å¸‚å€ (ç´„ 3.5-4 å°æ™‚)ï¼Œä¸¦åœ¨æ©Ÿå ´é™„è¿‘é‚„è»Šã€‚</div>
                    <div class="note editable" data-field="note">ç§Ÿè»Šé‚„è»Šæ‰‹çºŒã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D5A4">
                <div class="time-box editable" data-field="time">17:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">â›©ï¸ <a href="https://www.google.com/maps/search/?api=1&query=å¤ªå®°åºœå¤©æ»¿å®®" target="_blank">å¤ªå®°åºœå¤©æ»¿å®®</a></div>
                    <div class="description-text editable" data-field="desc">ä¹å·æœ€é‡è¦çš„ç¥ç¤¾ä¹‹ä¸€ï¼Œä¾›å¥‰å­¸å•ä¹‹ç¥ï¼Œåƒé“ä¸Šçš„æ¢…æé¤…æ˜¯å¿…åšç¾é£Ÿã€‚</div>
                    <div class="note editable" data-field="note">é–‹è»Šå›åˆ°ç¦å²¡å¸‚å€å¾Œï¼Œå¯å…ˆå‰å¾€å¤ªå®°åºœã€‚</div>
                </div>
            </div>
            <div class="activity-card" data-id="D5A5">
                <div class="time-box editable" data-field="time">18:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ›ï¸ <a href="https://www.google.com/maps/search/?api=1&query=ã‚¹ã‚«ã‚¤ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼åšå¤šé§…åº—2" target="_blank">å¤©ç¥LOFT</a></div>
                    <div class="description-text editable" data-field="desc">åœ¨å¤©ç¥åœ°å€çš„LOFTè³¼ç‰©ï¼Œæ¡è³¼ç‰¹è‰²æ–‡å…·ã€é›œè²¨ã€‚</div>
                    <div class="note editable" data-field="note">å¯é †é“åœ¨é™„è¿‘è²·æ˜å¤ªå­éºµåŒ…ã€‚</div>
                </div>
            </div>
             <div class="activity-card" data-id="D5A6">
                <div class="time-box editable" data-field="time">18:40</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ è²·æ˜å¤ªå­éºµåŒ…</div>
                    <div class="description-text editable" data-field="desc">åœ¨å¤©ç¥LOFTé™„è¿‘æˆ–å¤©ç¥åœ°ä¸‹è¡—å°‹æ‰¾ç¦å²¡ç‰¹è‰²æ˜å¤ªå­éºµåŒ… (ä¾‹å¦‚ï¼š**Pain Stock** æˆ–è»Šç«™åº—)ã€‚</div>
                    <div class="note editable" data-field="note"></div>
                </div>
            </div>
            <div class="activity-card" data-id="D5A7">
                <div class="time-box editable" data-field="time">19:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ¥© <a href="https://www.google.com/maps/search/?api=1&query=ZONK+HOTEL+Hakata" target="_blank">ç‡’è‚‰ Nikuichi (Yakuin Store)</a></div>
                    <div class="description-text editable" data-field="desc">äº«ç”¨å·²é è¨‚çš„ç¾å‘³ç‡’è‚‰ã€‚</div>
                    <div class="note editable" data-field="note">å·²è¨‚ä½ã€‚</div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D5A8">
                <div class="time-box editable" data-field="time">ä½</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ¨ <a href="https://www.google.com/maps/search/?api=1&query=ã‚¹ã‚«ã‚¤ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼åšå¤šé§…åº—3" target="_blank">Quintessa Hotel Fukuoka Tenjin Minami</a></div>
                    <div class="description-text editable" data-field="desc">å›åˆ°ç¦å²¡å¸‚å€çš„ä½å®¿é»ï¼Œæ–¹ä¾¿éš”å¤©å‰å¾€æ©Ÿå ´ã€‚</div>
                    <div class="note editable" data-field="note">ç¦å²¡å¸‚å€ä½å®¿ã€‚</div>
                </div>
            </div>
        </div>

        <div class="itinerary-day" id="D6">
            <div class="day-header">
                <div class="day-title">1 æœˆ 6 æ—¥ (å…­) - è¿”ç¨‹</div>
                <div class="weather-box" id="weather-D6"></div>
            </div>
            <div class="activity-card" data-id="D6A1">
                <div class="time-box editable" data-field="time">ä¸Šåˆ</div>
                <div class="details">
                    <div class="location editable" data-field="location">âœˆï¸ å‰å¾€æ©Ÿå ´</div>
                    <div class="description-text editable" data-field="desc">å¾ Quintessa Hotel æ­ä¹˜åœ°éµæˆ–è¨ˆç¨‹è»Šå‰å¾€ç¦å²¡æ©Ÿå ´ã€‚</div>
                    <div class="note editable" data-field="note"></div>
                </div>
            </div>
            <div class="activity-card highlight" data-id="D6A2">
                <div class="time-box editable" data-field="time">12:00</div>
                <div class="details">
                    <div class="location editable" data-field="location">ğŸ›« ç™»æ©Ÿ</div>
                    <div class="description-text editable" data-field="desc">æ­ä¹˜é£›æ©Ÿè¿”å›ã€‚</div>
                    <div class="note editable" data-field="note"></div>
                </div>
            </div>
        </div>

        <div class="itinerary-day" id="D7">
            <div class="day-header">
                <div class="day-title">ğŸ’¸ æ—…è²»ç´€éŒ„ç¸½è¦½</div>
                <div class="weather-box"></div>
            </div>

            <div class="currency-control">
                ç¸½è¨ˆå¹£åˆ¥ï¼š
                <select id="currency-select" class="currency-select" onchange="updateTotal()">
                    <option value="JPY">æ—¥å¹£ (Â¥)</option>
                    <option value="TWD">å°å¹£ (NTD)</option>
                </select>
                <span style="font-size: 0.8em; color: #a0a0a0;"> (å–®ç­†é‡‘é¡è«‹çµ±ä¸€è¼¸å…¥æ—¥å¹£)</span>
            </div>

            <table id="expense-table" style="width:100%; border-collapse: collapse;">
                <thead>
                    <tr style="background-color: #7f8c8d; color: white;">
                        <td style="width:25%;">é¡åˆ¥</td>
                        <td style="width:45%;">é …ç›®èªªæ˜</td>
                        <td style="width:20%; text-align: right;">æ—¥å¹£ (Â¥)</td>
                        <td style="width:10%;">æ“ä½œ</td>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
                <tfoot>
                    <tr>
                        <td colspan="2" style="text-align: right; font-weight: bold; background-color: #f7f5f0;">ç¸½è¨ˆ (<span id="currency-symbol">Â¥</span>)ï¼š</td>
                        <td id="total-expense" style="text-align: right; font-weight: bold; background-color: #f7f5f0;">0</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>

            <button onclick="addExpense()" style="margin-top: 20px; padding: 10px 15px; background-color: #bca47c; color: white; border: none; border-radius: 5px; cursor: pointer;">+ æ–°å¢èŠ±è²»ç´€éŒ„</button>
            <div style="margin-top: 15px; font-size: 0.9em; color: #888;">
                * æç¤ºï¼šé»æ“Šè¡¨æ ¼ä¸­çš„ä»»ä¸€æ¬„ä½å³å¯ç›´æ¥ç·¨è¼¯å…§å®¹ã€‚
            </div>
        </div>

    </div>

    <script>
        // ------------------------------------
        // JavaScript for Interactivity
        // ------------------------------------
        
        // åŒ¯ç‡è¨­å®šï¼š1 å°å¹£ (NTD) å…Œæ› X æ—¥åœ“ (Â¥)
        const TWD_TO_JPY_RATE = 4.7; 

        // 1. Tab Switching Logic
        const dayTabs = document.querySelectorAll('.day-tab');
        const itineraryDays = document.querySelectorAll('.itinerary-day');

        dayTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const dayId = tab.getAttribute('data-day');

                // Update active state for tabs
                dayTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update active state for itinerary content
                itineraryDays.forEach(day => {
                    day.classList.remove('active');
                    if (day.id === dayId) {
                        day.classList.add('active');
                    }
                });
            });
        });

        // 2. Inline Editing Logic (for Itinerary)
        document.querySelectorAll('.editable').forEach(element => {
            element.addEventListener('click', function(e) {
                // Prevent editing if clicking on a link
                if (e.target.tagName === 'A') {
                    return;
                }
                
                // Get current text content, including preserving inner <a> tags if present
                let contentHTML = this.innerHTML;
                let contentText = this.textContent;

                // Create input element
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'editable-input';
                input.value = contentText.trim(); 
                
                // Replace the editable div with the input field
                this.style.display = 'none';
                this.parentNode.insertBefore(input, this);

                // Focus on the input field
                input.focus();

                // Function to save changes
                const saveChanges = () => {
                    let newValue = input.value.trim();
                    
                    // Simple replacement, requires user to re-add link structure if needed
                    this.innerHTML = newValue;
                    
                    // Remove the input field and show the div
                    input.parentNode.removeChild(input);
                    this.style.display = 'block';
                };

                // Save changes on blur (loss of focus)
                input.addEventListener('blur', saveChanges);

                // Save changes on Enter key press
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        saveChanges();
                    }
                });
            });
        });

        // 3. Expense Tracking Logic
        
        let expenseCounter = 4; // Start counter after the provided examples
        const expenseTableBody = document.querySelector('#expense-table tbody');
        const totalExpenseFoot = document.getElementById('total-expense');
        const currencySelect = document.getElementById('currency-select');
        const currencySymbolSpan = document.getElementById('currency-symbol');
        const categoryOptions = ['ä½å®¿', 'æ™¯é»', 'é¤å»³', 'è³¼ç‰©', 'äº¤é€š', 'å…¶ä»–'];


        // Load expenses from local storage (if any)
        function loadExpenses() {
            let expenses = JSON.parse(localStorage.getItem('travelchiahaho_expenses')) || getInitialExpenses();
            expenseTableBody.innerHTML = '';
            
            expenses.forEach(item => {
                appendExpenseRow(item.category, item.description, item.amount, item.id);
                // Keep the counter updated
                if (parseInt(item.id.substring(1)) >= expenseCounter) {
                    expenseCounter = parseInt(item.id.substring(1)) + 1;
                }
            });
            updateTotal();
            makeExpensesEditable();
        }

        function getInitialExpenses() {
             // Hardcoded initial data, removed 'date' field
            return [
                { id: 'E1', category: 'ä½å®¿', description: 'S-Peria Hotel Hakata (1æ™š)', amount: '15,000' },
                { id: 'E2', category: 'äº¤é€š', description: 'ç§Ÿè»Šè²»ç”¨ (3æ—¥)', amount: '12,000' },
                { id: 'E3', category: 'æ™¯é»', description: 'ä¹å·é‡ç”Ÿå‹•ç‰©åœ’é–€ç¥¨', amount: '5,000' }
            ];
        }

        // Save expenses to local storage
        function saveExpenses() {
            const rows = expenseTableBody.querySelectorAll('tr');
            let expenses = [];
            rows.forEach(row => {
                expenses.push({
                    id: row.getAttribute('data-id'),
                    // For category: if it's a select, get the value. If it's a td (after editing), get textContent.
                    category: row.querySelector('[data-field="category"]').tagName === 'SELECT' ? 
                              row.querySelector('[data-field="category"]').value :
                              row.querySelector('[data-field="category"]').textContent.trim(),
                    description: row.querySelector('[data-field="description"]').textContent.trim(),
                    amount: row.querySelector('[data-field="amount"]').textContent.trim(),
                });
            });
            localStorage.setItem('travelchiahaho_expenses', JSON.stringify(expenses));
            updateTotal();
        }
        
        // Helper to create category select element
        function createCategorySelect(selectedValue = 'å…¶ä»–') {
            const select = document.createElement('select');
            select.className = 'category-select';
            select.setAttribute('data-field', 'category');
            
            categoryOptions.forEach(optionText => {
                const option = document.createElement('option');
                option.value = optionText;
                option.textContent = optionText;
                if (optionText === selectedValue) {
                    option.selected = true;
                }
                select.appendChild(option);
            });

            // Add event listener to save changes immediately on change
            select.addEventListener('change', saveExpenses); 
            
            return select;
        }


        // Add a new expense row (removed date argument)
        function appendExpenseRow(category, description, amount, id) {
            const newRow = document.createElement('tr');
            newRow.setAttribute('data-id', id);
            
            // Create the category cell with the select element
            const categoryCell = document.createElement('td');
            categoryCell.appendChild(createCategorySelect(category));
            
            newRow.innerHTML = `
                ${categoryCell.outerHTML}
                <td class="expense-editable" data-field="description">${description}</td>
                <td class="expense-editable" data-field="amount" style="text-align: right;">${amount}</td>
                <td><button class="delete-btn" onclick="deleteExpense('${id}')">âŒ</button></td>
            `;
            // Manually replace the generated td HTML with the actual select element
            newRow.querySelector('td:first-child').innerHTML = '';
            newRow.querySelector('td:first-child').appendChild(createCategorySelect(category));

            expenseTableBody.appendChild(newRow);
        }

        window.addExpense = function() {
            const newId = 'E' + expenseCounter++;
            // Default to 'é¤å»³' for a new row
            appendExpenseRow('é¤å»³', 'æ–°å¢é …ç›®', '0', newId);
            saveExpenses();
            makeExpensesEditable(); // Make the new row editable
        }

        window.deleteExpense = function(id) {
            const row = document.querySelector(`tr[data-id="${id}"]`);
            if (row) {
                row.remove();
                saveExpenses();
            }
        }

        window.updateTotal = function() {
            const amountCells = expenseTableBody.querySelectorAll('[data-field="amount"]');
            let totalJPY = 0;
            amountCells.forEach(cell => {
                // Get the hidden original JPY value (stored in data attribute) or from content (if new entry)
                const jpyValue = parseFloat(cell.getAttribute('data-jpy') || cell.textContent.replace(/,/g, ''));
                if (!isNaN(jpyValue)) {
                    totalJPY += jpyValue;
                }
            });
            
            const selectedCurrency = currencySelect.value;
            let totalDisplay = 0;
            let symbol = '';

            if (selectedCurrency === 'TWD') {
                // Convert JPY total to TWD (JPY / Rate)
                totalDisplay = totalJPY / TWD_TO_JPY_RATE;
                symbol = 'NTD';
            } else { // JPY
                totalDisplay = totalJPY;
                symbol = 'Â¥';
            }

            currencySymbolSpan.textContent = symbol;
            
            // Format total with commas and appropriate decimal places
            totalExpenseFoot.textContent = totalDisplay.toLocaleString('en-US', {
                maximumFractionDigits: selectedCurrency === 'TWD' ? 0 : 0
            }); 
        }

        function makeExpensesEditable() {
            // Make Description and Amount editable
            document.querySelectorAll('.expense-editable[data-field="description"], .expense-editable[data-field="amount"]').forEach(element => {
                element.removeEventListener('click', handleExpenseEdit); // Remove old listener first
                element.addEventListener('click', handleExpenseEdit);
            });
            
            // Re-attach change listeners to all category selects (for consistency)
            document.querySelectorAll('.category-select').forEach(select => {
                select.removeEventListener('change', saveExpenses);
                select.addEventListener('change', saveExpenses);
            });
        }

        function handleExpenseEdit() {
            const originalElement = this;
            const field = originalElement.getAttribute('data-field');
            const originalText = originalElement.getAttribute('data-jpy') || originalElement.textContent.trim(); // Use hidden JPY value if available

            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'editable-input';
            input.value = originalText;
            input.style.width = '100%';
            input.style.textAlign = field === 'amount' ? 'right' : 'left';
            input.style.padding = '0';
            input.style.border = 'none';
            input.style.margin = '0';
            
            // Replace the td content with the input field
            originalElement.innerHTML = '';
            originalElement.appendChild(input);
            input.focus();

            const saveChanges = () => {
                let newValue = input.value.trim();

                if (field === 'amount') {
                    // For amount field, strip non-digits/commas
                    const cleanValue = newValue.replace(/[^0-9.]/g, '');
                    const numberValue = parseFloat(cleanValue);
                    
                    if (!isNaN(numberValue)) {
                        // Store clean JPY value in a hidden attribute
                        originalElement.setAttribute('data-jpy', numberValue);
                        // Display value formatted with commas
                        newValue = numberValue.toLocaleString('en-US', {maximumFractionDigits: 0});
                    } else {
                        // If invalid input, use the stored JPY value or 0
                        const storedJpy = originalElement.getAttribute('data-jpy') || '0';
                        const storedNum = parseFloat(storedJpy);
                        originalElement.setAttribute('data-jpy', storedNum);
                        newValue = storedNum.toLocaleString('en-US', {maximumFractionDigits: 0});
                    }
                }
                
                originalElement.textContent = newValue;
                saveExpenses();
                // Re-attach the click listener
                originalElement.addEventListener('click', handleExpenseEdit, { once: true });
            };

            // Save changes on blur (loss of focus)
            input.addEventListener('blur', saveChanges);

            // Save changes on Enter key press
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    saveChanges();
                    input.blur(); // Trigger blur to ensure save
                }
            });
            
            // Prevent recursive editing
            originalElement.removeEventListener('click', handleExpenseEdit);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
             // Check if local storage exists; if not, populate with initial data and save
            if (!localStorage.getItem('travelchiahaho_expenses')) {
                const initialExpenses = getInitialExpenses();
                localStorage.setItem('travelchiahaho_expenses', JSON.stringify(initialExpenses));
            }
            loadExpenses();
            makeExpensesEditable();
            
            // Manually set initial data-jpy attributes on load for consistency
            document.querySelectorAll('[data-field="amount"]').forEach(cell => {
                if (!cell.getAttribute('data-jpy')) {
                    const jpyValue = parseFloat(cell.textContent.replace(/,/g, ''));
                    if (!isNaN(jpyValue)) {
                        cell.setAttribute('data-jpy', jpyValue);
                    } else {
                         cell.setAttribute('data-jpy', 0);
                    }
                }
            });
            updateTotal(); // Ensure total is calculated correctly on load
        });

    </script>
</body>
</html>
